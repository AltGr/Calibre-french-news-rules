__license__   = 'GPL v3'
__copyright__ = '2010-2012, Louis Gesbert <meta at antislash dot info>'
'''
Rue89
'''

__author__ = '2010-2012, Louis Gesbert <meta at antislash dot info>'

import re
from calibre.ebooks.BeautifulSoup import Tag
from calibre.web.feeds.news import BasicNewsRecipe

class Rue89(BasicNewsRecipe):
    title = 'Rue89'
    __author__ = 'Louis Gesbert'
    description = 'Popular free french news website'
    title = u'Rue89'
    language = 'fr'
    oldest_article = 7
    max_articles_per_feed = 12

    # From http://www.rue89.com/les-flux-rss-de-rue89
    feeds = [
        (u'La Une',    u'http://www.rue89.com/feed'),
        (u'Rue69',     u'http://www.rue89.com/rue69/feed'),
        (u'Eco',       u'http://www.rue89.com/rue89-eco/feed'),
        (u'Plan√®te',   u'http://www.rue89.com/rue89-planete/feed'),
        (u'Sport',     u'http://www.rue89.com/rue89-sport/feed'),
        (u'Culture',   u'http://www.rue89.com/culture/feed'),
        (u'Hi-tech',   u'http://www.rue89.com/hi-tech/feed'),
        (u'Media',     u'http://www.rue89.com/medias/feed'),
        (u'Monde',     u'http://www.rue89.com/monde/feed'),
        (u'Politique', u'http://www.rue89.com/politique/feed'),
        (u'Societe',   u'http://www.rue89.com/societe/feed'),
    ]

    no_stylesheets = True

    conversion_options = { 'smarten_punctuation' : True }

    def preprocess_html(self,soup):
        body = Tag(soup, 'body')
        title = soup.find('h1', {'class':'title'})
        content = soup.find('div', {'class':'content'})
        soup.body.replaceWith(body)
        body.insert(0, title)
        body.insert(1, content)
        return soup
